数据库中的锁

# 一、共享锁、排他锁

在非serializable级别下，查询不添加任何锁。

在serializable级别下，查询会添加共享锁，写操作会添加排他锁。

## 特点

共享锁和共享锁可以共存。

共享锁和排他锁不能共存。

排他锁和任何锁都不能共存。

若共享锁和排他锁同时出现，后一个锁需要等待前一个事务锁释放，才可以继续执行当前事务。

# 二、死锁

两个或多个线程相互等待对方释放资源产生死锁。

## 解决办法

1. 任意杀死一个线程，另外一个线程就会正常执行。

2. 优化锁方案，将锁住部分的代码进行修改，避免死锁的出现。

# 三、行级锁和表级锁

行级锁：为某一行添加锁，被锁住的行只允许被一个线程操作。

表级锁：为选中的表添加一个表级锁，被锁住的表只允许被一个线程操作。